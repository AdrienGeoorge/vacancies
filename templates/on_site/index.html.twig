{% extends 'trip/base.html.twig' %}

{% block bodyTrip %}
    <div class="grid grid-cols-4 gap-4">
        <div class="shadow rounded-3xl bg-box dark:bg-box-dark py-3.5 px-6 col-span-4 md:col-span-3">
            <div class="mb-2 flex flex-row items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                    <path fill-rule="evenodd"
                          d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.902 7.098a3.75 3.75 0 0 1 3.903-.884.75.75 0 1 0 .498-1.415A5.25 5.25 0 0 0 8.005 9.75H7.5a.75.75 0 0 0 0 1.5h.054a5.281 5.281 0 0 0 0 1.5H7.5a.75.75 0 0 0 0 1.5h.505a5.25 5.25 0 0 0 6.494 2.701.75.75 0 1 0-.498-1.415 3.75 3.75 0 0 1-4.252-1.286h3.001a.75.75 0 0 0 0-1.5H9.075a3.77 3.77 0 0 1 0-1.5h3.675a.75.75 0 0 0 0-1.5h-3c.105-.14.221-.274.348-.402Z"
                          clip-rule="evenodd"></path>
                </svg>
                <div class="font-poppins-semi-bold text-xl">Dépenses sur place</div>
            </div>
            <div class="text-sm">
                Définissez qui est à l'origine d'une dépense effectuée lors du séjour, telle qu'un repas au restaurant,
                des achats en magasin, etc...
            </div>
        </div>

        <a href="{{ path('trip_on_site_new', {'trip': trip.id}) }}" class="shadow rounded-3xl py-3.5 px-6 flex flex-col gap-2 items-center justify-center text-center
                          col-span-4 md:col-span-1
                          tracking-wide bg-teal-500 text-white
                                    border border-teal-300 hover:bg-teal-600
                                    transition-all duration-300 ease-in-out focus:shadow-outline focus:outline-none">
            <span class="bg-teal-400 rounded-full p-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                    <path fill-rule="evenodd"
                          d="M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z"
                          clip-rule="evenodd"></path>
                </svg>
            </span>
            <span>Nouvelle dépense</span>
        </a>
    </div>

    <div class="mt-4">
        {% if not trip.onSiteExpenses.empty %}
            <div class="flex flex-col gap-3">
                {% for expense in trip.onSiteExpenses|sort((a, b) => a.purchaseDate < b.purchaseDate) %}
                    <div class="shadow rounded-3xl bg-box dark:bg-box-dark py-3.5 px-6 flex flex-col md:flex-row gap-4 justify-between sm:items-start md:items-center">
                        <div class="flex flex-col">
                            <div class="font-poppins-semi-bold text-lg">{{ expense.name }}</div>
                            <div>
                                <span class="font-poppins-semi-bold">Payé par</span>
                                <span>{{ expense.payedBy.name }}</span><br>
                                <span class="font-poppins-semi-bold">Le</span>
                                <span>{{ expense.purchaseDate|date('d/m/Y à H:i') }}</span>
                            </div>
                        </div>
                        <div class="flex flex-row gap-4 items-center">
                            <div class="rounded-full bg-body dark:bg-body-dark w-fit px-3 py-1">
                                <span class="font-bold">{{ expense.price }}€</span>
                            </div>
                            <a href="{{ path('trip_on_site_edit', {'trip': trip.id, 'expense': expense.id}) }}"
                               class="bg-blue-500 border-2 border-blue-400 text-white text-center py-2 px-5 rounded-full">Editer</a>
                        </div>
                    </div>
                {% endfor %}
            </div>

        {% else %}
            <div class="shadow rounded-3xl bg-red-400 text-white py-3.5 px-6">
                Aucune dépense effectuée sur place n'a été trouvée pour ce voyage.
            </div>
        {% endif %}
    </div>
{% endblock %}